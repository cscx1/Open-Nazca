<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Code Security Scan Report</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        .scan-info {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .summary-card h3 {
            margin: 0 0 10px 0;
            font-size: 0.9em;
            color: #666;
            text-transform: uppercase;
        }
        .summary-card .count {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }
        .critical { color: #dc3545; }
        .high { color: #fd7e14; }
        .medium { color: #ffc107; }
        .low { color: #0dcaf0; }
        .finding {
            background: white;
            padding: 25px;
            margin-bottom: 20px;
            border-radius: 8px;
            border-left: 5px solid #ddd;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .finding.critical { border-left-color: #dc3545; }
        .finding.high { border-left-color: #fd7e14; }
        .finding.medium { border-left-color: #ffc107; }
        .finding.low { border-left-color: #0dcaf0; }
        .finding h3 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .finding .severity-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            color: white;
            margin-bottom: 15px;
        }
        .finding .code-snippet {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 15px 0;
        }
        .finding .section {
            margin: 15px 0;
        }
        .finding .section-title {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîí AI Code Security Scan Report</h1>
        <p>Automated vulnerability detection for AI systems</p>
    </div>

    <div class="scan-info">
        <h2>Scan Information</h2>
        <p><strong>File:</strong> Test3.py</p>
        <p><strong>Language:</strong> python</p>
        <p><strong>Scan Time:</strong> 2026-02-10 22:28:28</p>
        <p><strong>Scan ID:</strong> local-1770780508</p>
    </div>

    <h2>Summary</h2>
    <div class="summary">
        <div class="summary-card">
            <h3>Critical</h3>
            <div class="count critical">11</div>
        </div>
        <div class="summary-card">
            <h3>High</h3>
            <div class="count high">14</div>
        </div>
        <div class="summary-card">
            <h3>Medium</h3>
            <div class="count medium">5</div>
        </div>
        <div class="summary-card">
            <h3>Low</h3>
            <div class="count low">0</div>
        </div>
    </div>

    <h2>Detailed Findings</h2>

    <div class="finding critical">
        <h3>Hardcoded Secret</h3>
        <span class="severity-badge" style="background-color: #dc3545;">
            CRITICAL
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 28</strong><br>
            Detector: HardcodedSecretsDetector | 
            Confidence: 90%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Hardcoded password detected: Password appears to be hardcoded. Hardcoded secrets can be extracted by attackers who gain access to source code, version control history, or compiled binaries. This can lead to unauthorized access, data breaches, and service compromise. Value: supe..._123
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre> 26   | 
 27   | # ============ VULNERABILITY 1: Hardcoded credentials ============
 28 ‚Üí | DB_PASSWORD = &quot;supe..._123&quot;
 29   | API_KEY = &quot;sk_live_51abc123def456&quot;
 30   | 
 31   | # ============ VULNERABILITY 2: Command injection with eval ============</pre></div>
        </div>
    </div>

    <div class="finding critical">
        <h3>Hardcoded Secret</h3>
        <span class="severity-badge" style="background-color: #dc3545;">
            CRITICAL
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 29</strong><br>
            Detector: HardcodedSecretsDetector | 
            Confidence: 90%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Hardcoded API key detected: API Key appears to be hardcoded. Hardcoded secrets can be extracted by attackers who gain access to source code, version control history, or compiled binaries. This can lead to unauthorized access, data breaches, and service compromise. Value: sk_l...f456
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre> 27   | # ============ VULNERABILITY 1: Hardcoded credentials ============
 28   | DB_PASSWORD = &quot;super_secret_123&quot;
 29 ‚Üí | API_KEY = &quot;sk_l...f456&quot;
 30   | 
 31   | # ============ VULNERABILITY 2: Command injection with eval ============
 32   | @app.route(&#x27;/execute&#x27;, methods=[&#x27;POST&#x27;])</pre></div>
        </div>
    </div>

    <div class="finding high">
        <h3>Weak Random</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 87</strong><br>
            Detector: WeakRandomDetector | 
            Confidence: 93%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Predictable random.seed(...) detected. Seed values derived from time/process data are guessable and make PRNG output predictable.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre> 85   |     &quot;&quot;&quot;Predictable random token&quot;&quot;&quot;
 86   |     # VULNERABLE: time-based seed
 87 ‚Üí |     random.seed(datetime.datetime.now().timestamp())
 88   |     return &#x27;&#x27;.join(random.choices(&#x27;0123456789&#x27;, k=6))
 89   | 
 90   | # ============ VULNERABILITY 9: XML External Entity ============</pre></div>
        </div>
    </div>

    <div class="finding high">
        <h3>Weak Hash</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 81</strong> in function <code>generate_token</code><br>
            Detector: WeakHashDetector | 
            Confidence: 93%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Weak hashing algorithm &#x27;md5&#x27; detected. Algorithms like MD5 and SHA-1 are cryptographically broken and vulnerable to collision attacks. Use SHA-256 or stronger for security-sensitive hashing.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre> 79   |     &quot;&quot;&quot;Weak MD5 password hashing&quot;&quot;&quot;
 80   |     # VULNERABLE: MD5 is broken
 81 ‚Üí |     return hashlib.md5(password.encode()).hexdigest()
 82   | 
 83   | # ============ VULNERABILITY 8: Insecure random token ============
 84   | def generate_token():</pre></div>
        </div>
    </div>

    <div class="finding high">
        <h3>XML External Entity (XXE)</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 94</strong> in function <code>parse_xml</code><br>
            Detector: XXEDetector | 
            Confidence: 88%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Stdlib XML parser used without defusedxml. Python&#x27;s built-in XML parsers do not fully prevent XXE attacks. Replace with defusedxml equivalents.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre> 91   | def parse_xml(xml_data):
 92   |     &quot;&quot;&quot;XXE vulnerability&quot;&quot;&quot;
 93   |     # CRITICAL: No XXE protection
 94 ‚Üí |     root = ET.fromstring(xml_data)
 95   |     return root.tag
 96   | 
 97   | # ============ VULNERABILITY 10: Shell injection with shell=True ============
 98   | def list_directory(path):</pre></div>
        </div>
    </div>

    <div class="finding critical">
        <h3>Unsafe Deserialization</h3>
        <span class="severity-badge" style="background-color: #dc3545;">
            CRITICAL
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 75</strong> in function <code>load_user_data</code><br>
            Detector: DeserializationDetector | 
            Confidence: 92%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Unsafe deserialization via pickle.loads(): pickle deserialization allows arbitrary code execution. An attacker controlling the serialized payload can achieve remote code execution.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre> 72   | def load_user_data(data):
 73   |     &quot;&quot;&quot;Pickle deserialization RCE&quot;&quot;&quot;
 74   |     # CRITICAL: Untrusted pickle loading
 75 ‚Üí |     return pickle.loads(base64.b64decode(data))
 76   | 
 77   | # ============ VULNERABILITY 7: Weak password hashing ============
 78   | def hash_password(password):
 79   |     &quot;&quot;&quot;Weak MD5 password hashing&quot;&quot;&quot;</pre></div>
        </div>

        <div class="section">
            <div class="section-title">üîç Reachability:</div>
            <span style="display:inline-block;padding:3px 10px;border-radius:12px;
                         background:#dc3545;color:white;font-size:0.85em;font-weight:bold;">
                Confirmed Reachable
            </span>
            <p style="margin-top:8px;font-size:0.9em;color:#555;">Tainted data flows from data (line 72) to pickle.loads (line 75) with no sanitiser detected. The path is considered reachable.</p>
        </div>

        <div class="section">
            <div class="section-title">üéØ Sink API:</div>
            <code>pickle.loads</code>
        </div>

        <div class="section">
            <div class="section-title">üó∫Ô∏è Attack Path:</div>
            <div style="background:#f0f0f0;padding:10px;border-radius:4px;font-size:0.9em;">
                <strong>data</strong> <small>(line 72)</small> &rarr; <strong>pickle.loads</strong> <small>(line 75)</small>
            </div>
        </div>
    </div>

    <div class="finding critical">
        <h3>Unsafe Deserialization</h3>
        <span class="severity-badge" style="background-color: #dc3545;">
            CRITICAL
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 109</strong> in function <code>load_config</code><br>
            Detector: DeserializationDetector | 
            Confidence: 92%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Unsafe deserialization via yaml.load(): yaml.load can instantiate arbitrary Python objects. An attacker controlling the serialized payload can achieve remote code execution.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre>106   | def load_config(yaml_str):
107   |     &quot;&quot;&quot;YAML deserialization RCE&quot;&quot;&quot;
108   |     # CRITICAL: Unsafe YAML loading
109 ‚Üí |     return yaml.load(yaml_str, Loader=yaml.Loader)
110   | 
111   | # ============ VULNERABILITY 12: ReDoS vulnerability ============
112   | def validate_email(email):
113   |     &quot;&quot;&quot;Exponential ReDoS regex&quot;&quot;&quot;</pre></div>
        </div>

        <div class="section">
            <div class="section-title">üîç Reachability:</div>
            <span style="display:inline-block;padding:3px 10px;border-radius:12px;
                         background:#dc3545;color:white;font-size:0.85em;font-weight:bold;">
                Confirmed Reachable
            </span>
            <p style="margin-top:8px;font-size:0.9em;color:#555;">Tainted data flows from yaml_str (line 106) to yaml.load (line 109) with no sanitiser detected. The path is considered reachable.</p>
        </div>

        <div class="section">
            <div class="section-title">üéØ Sink API:</div>
            <code>yaml.load</code>
        </div>

        <div class="section">
            <div class="section-title">üó∫Ô∏è Attack Path:</div>
            <div style="background:#f0f0f0;padding:10px;border-radius:4px;font-size:0.9em;">
                <strong>yaml_str</strong> <small>(line 106)</small> &rarr; <strong>yaml.load</strong> <small>(line 109)</small>
            </div>
        </div>
    </div>

    <div class="finding critical">
        <h3>Unsafe Deserialization</h3>
        <span class="severity-badge" style="background-color: #dc3545;">
            CRITICAL
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 235</strong><br>
            Detector: DeserializationDetector | 
            Confidence: 92%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Unsafe deserialization via pickle.loads(): pickle deserialization allows arbitrary code execution. An attacker controlling the serialized payload can achieve remote code execution.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre>232   |     
233   |     # 3. Deserialization
234   |     pickle_data = data.get(&#x27;pickle&#x27;, &#x27;&#x27;)
235 ‚Üí |     pickle.loads(base64.b64decode(pickle_data))
236   |     
237   |     # 4. XSS
238   |     name = data.get(&#x27;name&#x27;, &#x27;&#x27;)
239   |     return f&quot;&lt;script&gt;alert(&#x27;Hello {name}&#x27;)&lt;/script&gt;&quot;</pre></div>
        </div>
    </div>

    <div class="finding high">
        <h3>Path Traversal</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 181</strong> in function <code>write_to_file</code><br>
            Detector: TOCTOUDetector | 
            Confidence: 85%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Time-of-check to time-of-use (TOCTOU) race condition: file &#x27;filename&#x27; is checked on line 179 then used on line 181. Between check and use, an attacker can replace the file with a symlink to a sensitive resource. Use atomic operations or open-then-check patterns.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre>177   | def write_to_file(filename, content):
178   |     &quot;&quot;&quot;TOCTOU race condition&quot;&quot;&quot;
179   |     if os.path.exists(filename):
180   |         # CRITICAL: Race between check and write
181 ‚Üí |         with open(filename, &#x27;w&#x27;) as f:
182   |             f.write(content)
183   |         return True
184   |     return False
185   | 
186   | # ============ VULNERABILITY 21: Unsafe redirect ============</pre></div>
        </div>

        <div class="section">
            <div class="section-title">üîç Reachability:</div>
            <span style="display:inline-block;padding:3px 10px;border-radius:12px;
                         background:#dc3545;color:white;font-size:0.85em;font-weight:bold;">
                Confirmed Reachable
            </span>
            <p style="margin-top:8px;font-size:0.9em;color:#555;">Tainted data flows from filename (line 177) to open (line 181) with no sanitiser detected. The path is considered reachable.</p>
        </div>

        <div class="section">
            <div class="section-title">üéØ Sink API:</div>
            <code>open</code>
        </div>

        <div class="section">
            <div class="section-title">üó∫Ô∏è Attack Path:</div>
            <div style="background:#f0f0f0;padding:10px;border-radius:4px;font-size:0.9em;">
                <strong>filename</strong> <small>(line 177)</small> &rarr; <strong>open</strong> <small>(line 181)</small>
            </div>
        </div>
    </div>

    <div class="finding high">
        <h3>Mass Assignment</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 123</strong> in function <code>__init__</code><br>
            Detector: TypeConfusionDetector | 
            Confidence: 88%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            setattr() called in a loop over dictionary items. An attacker can inject arbitrary attributes including &#x27;is_admin&#x27;, &#x27;__class__&#x27;, or &#x27;__dict__&#x27; to escalate privileges or corrupt object state. Use an allowlist of permitted attribute names.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre>119   | class User:
120   |     def __init__(self, data):
121   |         # CRITICAL: Mass assignment
122   |         for key, value in data.items():
123 ‚Üí |             setattr(self, key, value)
124   | 
125   | # ============ VULNERABILITY 14: Log injection ============
126   | def log_action(username, action):
127   |     &quot;&quot;&quot;Log injection vulnerability&quot;&quot;&quot;
128   |     log_msg = f&quot;{datetime.datetime.now()} - {username} - {action}\n&quot;</pre></div>
        </div>
    </div>

    <div class="finding high">
        <h3>Reflected XSS</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 192</strong> in function <code>unsafe_redirect</code><br>
            Detector: XSSDetector | 
            Confidence: 88%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            User-controlled variable &#x27;url&#x27; is included in an HTML response without escaping. Use html.escape() or a template engine with auto-escaping.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre>188   | def unsafe_redirect():
189   |     &quot;&quot;&quot;Open redirect vulnerability&quot;&quot;&quot;
190   |     url = request.args.get(&#x27;url&#x27;, &#x27;/&#x27;)
191   |     # CRITICAL: No validation of redirect URL
192 ‚Üí |     return f&#x27;&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0; url={url}&quot;&gt;&#x27;
193   | 
194   | # ============ VULNERABILITY 22: Server-Side Request Forgery ============
195   | import requests
196   | 
197   | @app.route(&#x27;/fetch&#x27;)</pre></div>
        </div>
    </div>

    <div class="finding high">
        <h3>Reflected XSS</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 239</strong><br>
            Detector: XSSDetector | 
            Confidence: 88%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            User-controlled variable &#x27;name&#x27; is included in an HTML response without escaping. Use html.escape() or a template engine with auto-escaping.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre>235   |     pickle.loads(base64.b64decode(pickle_data))
236   |     
237   |     # 4. XSS
238   |     name = data.get(&#x27;name&#x27;, &#x27;&#x27;)
239 ‚Üí |     return f&quot;&lt;script&gt;alert(&#x27;Hello {name}&#x27;)&lt;/script&gt;&quot;
240   | 
241   | if __name__ == &#x27;__main__&#x27;:
242   |     app.run(debug=True)  # CRITICAL: Debug mode in production</pre></div>
        </div>
    </div>

    <div class="finding high">
        <h3>Unsafe File Upload</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 147</strong><br>
            Detector: OperationalSecurityDetector | 
            Confidence: 90%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Uploaded file is saved without robust filename/content validation. Use secure_filename(), extension allowlists, MIME checks, and size limits.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre>144   |     filename = file.filename
145   |     
146   |     # CRITICAL: No validation, direct save
147 ‚Üí |     file.save(f&quot;/uploads/{filename}&quot;)
148   |     return &quot;File uploaded&quot;
149   | 
150   | # ============ VULNERABILITY 17: Information disclosure ============
151   | @app.route(&#x27;/debug&#x27;)</pre></div>
        </div>
    </div>

    <div class="finding medium">
        <h3>Information Disclosure</h3>
        <span class="severity-badge" style="background-color: #ffc107;">
            MEDIUM
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 156</strong><br>
            Detector: OperationalSecurityDetector | 
            Confidence: 88%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Sensitive runtime or system details are exposed to output. Avoid returning environment variables, version/build internals, or stack traces.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre>153   |     &quot;&quot;&quot;Information disclosure&quot;&quot;&quot;
154   |     # CRITICAL: Debug info exposed
155   |     return {
156 ‚Üí |         &#x27;python_version&#x27;: sys.version,
157   |         &#x27;cwd&#x27;: os.getcwd(),
158   |         &#x27;env_vars&#x27;: dict(os.environ)
159   |     }
160   | </pre></div>
        </div>
    </div>

    <div class="finding medium">
        <h3>Information Disclosure</h3>
        <span class="severity-badge" style="background-color: #ffc107;">
            MEDIUM
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 158</strong><br>
            Detector: OperationalSecurityDetector | 
            Confidence: 88%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Sensitive runtime or system details are exposed to output. Avoid returning environment variables, version/build internals, or stack traces.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre>155   |     return {
156   |         &#x27;python_version&#x27;: sys.version,
157   |         &#x27;cwd&#x27;: os.getcwd(),
158 ‚Üí |         &#x27;env_vars&#x27;: dict(os.environ)
159   |     }
160   | 
161   | # ============ VULNERABILITY 18: Insecure direct object reference ============
162   | @app.route(&#x27;/profile/&lt;user_id&gt;&#x27;)</pre></div>
        </div>
    </div>

    <div class="finding high">
        <h3>Memory Exhaustion</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 209</strong> in function <code>process_large_data</code><br>
            Detector: OperationalSecurityDetector | 
            Confidence: 91%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            User-influenced size is used for allocation without an upper bound. This can cause denial-of-service via memory exhaustion.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre>206   | def process_large_data(data_size):
207   |     &quot;&quot;&quot;Memory exhaustion DoS&quot;&quot;&quot;
208   |     # CRITICAL: No size limits
209 ‚Üí |     data = &#x27;A&#x27; * int(data_size)
210   |     return len(data)
211   | 
212   | # ============ VULNERABILITY 24: Format string vulnerability ============
213   | def log_with_format(username, action):</pre></div>
        </div>
    </div>

    <div class="finding high">
        <h3>Debug Mode Enabled</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 242</strong><br>
            Detector: OperationalSecurityDetector | 
            Confidence: 95%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Application is started with debug=True. In production this can expose interactive debugger and sensitive internals.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre>239   |     return f&quot;&lt;script&gt;alert(&#x27;Hello {name}&#x27;)&lt;/script&gt;&quot;
240   | 
241   | if __name__ == &#x27;__main__&#x27;:
242 ‚Üí |     app.run(debug=True)  # CRITICAL: Debug mode in production</pre></div>
        </div>
    </div>

    <div class="finding medium">
        <h3>Missing Security Headers</h3>
        <span class="severity-badge" style="background-color: #ffc107;">
            MEDIUM
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 25</strong><br>
            Detector: OperationalSecurityDetector | 
            Confidence: 60%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Web application does not appear to set key security headers (CSP, HSTS, X-Frame-Options, X-Content-Type-Options). Possible FP if headers are injected by reverse proxy/CDN.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre> 22   | import random
 23   | import datetime
 24   | 
 25 ‚Üí | app = Flask(__name__)
 26   | 
 27   | # ============ VULNERABILITY 1: Hardcoded credentials ============
 28   | DB_PASSWORD = &quot;super_secret_123&quot;
 29   | API_KEY = &quot;sk_live_51abc123def456&quot;</pre></div>
        </div>
    </div>

    <div class="finding high">
        <h3>Missing CSRF Protection</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 32</strong> in function <code>execute_command</code><br>
            Detector: OperationalSecurityDetector | 
            Confidence: 62%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            State-changing Flask endpoint is defined without visible CSRF protections. Possible FP if API-only or token-based auth.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre> 29   | API_KEY = &quot;sk_live_51abc123def456&quot;
 30   | 
 31   | # ============ VULNERABILITY 2: Command injection with eval ============
 32 ‚Üí | @app.route(&#x27;/execute&#x27;, methods=[&#x27;POST&#x27;])
 33   | def execute_command():
 34   |     &quot;&quot;&quot;Direct command execution via eval&quot;&quot;&quot;
 35   |     cmd = request.form.get(&#x27;command&#x27;, &#x27;&#x27;)
 36   |     # CRITICAL: Direct eval of user input</pre></div>
        </div>
    </div>

    <div class="finding medium">
        <h3>Missing Rate Limiting</h3>
        <span class="severity-badge" style="background-color: #ffc107;">
            MEDIUM
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 140</strong> in function <code>upload_file</code><br>
            Detector: OperationalSecurityDetector | 
            Confidence: 58%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Potentially sensitive/high-risk endpoint has no visible rate limiting decorator. Possible FP if enforced at gateway/WAF.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre>137   |     return &quot;Code executed&quot;
138   | 
139   | # ============ VULNERABILITY 16: Unsafe file upload ============
140 ‚Üí | @app.route(&#x27;/upload&#x27;, methods=[&#x27;POST&#x27;])
141   | def upload_file():
142   |     &quot;&quot;&quot;Unsafe file upload&quot;&quot;&quot;
143   |     file = request.files[&#x27;file&#x27;]
144   |     filename = file.filename</pre></div>
        </div>
    </div>

    <div class="finding medium">
        <h3>Missing Rate Limiting</h3>
        <span class="severity-badge" style="background-color: #ffc107;">
            MEDIUM
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 162</strong> in function <code>user_profile</code><br>
            Detector: OperationalSecurityDetector | 
            Confidence: 58%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Potentially sensitive/high-risk endpoint has no visible rate limiting decorator. Possible FP if enforced at gateway/WAF.
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre>159   |     }
160   | 
161   | # ============ VULNERABILITY 18: Insecure direct object reference ============
162 ‚Üí | @app.route(&#x27;/profile/&lt;user_id&gt;&#x27;)
163   | def user_profile(user_id):
164   |     &quot;&quot;&quot;Insecure direct object reference&quot;&quot;&quot;
165   |     # CRITICAL: No authorization check
166   |     return f&quot;Profile page for user {user_id}&quot;</pre></div>
        </div>
    </div>

    <div class="finding critical">
        <h3>Code Execution</h3>
        <span class="severity-badge" style="background-color: #dc3545;">
            CRITICAL
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 37</strong><br>
            Detector: StaticAnalysisPipeline | 
            Confidence: 90%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Tainted data reaches eval()
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre></pre></div>
        </div>

        <div class="section">
            <div class="section-title">üîç Reachability:</div>
            <span style="display:inline-block;padding:3px 10px;border-radius:12px;
                         background:#dc3545;color:white;font-size:0.85em;font-weight:bold;">
                Confirmed Reachable
            </span>
            <p style="margin-top:8px;font-size:0.9em;color:#555;">Tainted data flows from request.form.get (line 35) to eval (line 37) with no sanitiser detected. The path is considered reachable.</p>
        </div>

        <div class="section">
            <div class="section-title">üéØ Sink API:</div>
            <code>eval</code>
        </div>

        <div class="section">
            <div class="section-title">üó∫Ô∏è Attack Path:</div>
            <div style="background:#f0f0f0;padding:10px;border-radius:4px;font-size:0.9em;">
                <strong>request.form.get</strong> <small>(line 35)</small> &rarr; <strong>cmd</strong> <small>(line 35)</small> &rarr; <strong>f-string</strong> <small>(line 37)</small> &rarr; <strong>eval</strong> <small>(line 37)</small>
            </div>
        </div>
    </div>

    <div class="finding critical">
        <h3>SQL Injection</h3>
        <span class="severity-badge" style="background-color: #dc3545;">
            CRITICAL
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 48</strong><br>
            Detector: StaticAnalysisPipeline | 
            Confidence: 90%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Tainted data reaches cursor.execute()
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre></pre></div>
        </div>

        <div class="section">
            <div class="section-title">üîç Reachability:</div>
            <span style="display:inline-block;padding:3px 10px;border-radius:12px;
                         background:#dc3545;color:white;font-size:0.85em;font-weight:bold;">
                Confirmed Reachable
            </span>
            <p style="margin-top:8px;font-size:0.9em;color:#555;">Tainted data flows from user_id (line 41) to cursor.execute (line 48) with no sanitiser detected. The path is considered reachable.</p>
        </div>

        <div class="section">
            <div class="section-title">üéØ Sink API:</div>
            <code>cursor.execute</code>
        </div>

        <div class="section">
            <div class="section-title">üó∫Ô∏è Attack Path:</div>
            <div style="background:#f0f0f0;padding:10px;border-radius:4px;font-size:0.9em;">
                <strong>user_id</strong> <small>(line 41)</small> &rarr; <strong>f-string</strong> <small>(line 47)</small> &rarr; <strong>query</strong> <small>(line 47)</small> &rarr; <strong>cursor.execute</strong> <small>(line 48)</small>
            </div>
        </div>
    </div>

    <div class="finding high">
        <h3>Path Traversal</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 58</strong><br>
            Detector: StaticAnalysisPipeline | 
            Confidence: 90%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Tainted data reaches open()
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre></pre></div>
        </div>

        <div class="section">
            <div class="section-title">üîç Reachability:</div>
            <span style="display:inline-block;padding:3px 10px;border-radius:12px;
                         background:#dc3545;color:white;font-size:0.85em;font-weight:bold;">
                Confirmed Reachable
            </span>
            <p style="margin-top:8px;font-size:0.9em;color:#555;">Tainted data flows from request.args.get (line 55) to open (line 58) with no sanitiser detected. The path is considered reachable.</p>
        </div>

        <div class="section">
            <div class="section-title">üéØ Sink API:</div>
            <code>open</code>
        </div>

        <div class="section">
            <div class="section-title">üó∫Ô∏è Attack Path:</div>
            <div style="background:#f0f0f0;padding:10px;border-radius:4px;font-size:0.9em;">
                <strong>request.args.get</strong> <small>(line 55)</small> &rarr; <strong>filename</strong> <small>(line 55)</small> &rarr; <strong>open</strong> <small>(line 58)</small>
            </div>
        </div>
    </div>

    <div class="finding critical">
        <h3>XSS / Template Injection</h3>
        <span class="severity-badge" style="background-color: #dc3545;">
            CRITICAL
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 69</strong><br>
            Detector: StaticAnalysisPipeline | 
            Confidence: 90%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Tainted data reaches render_template_string()
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre></pre></div>
        </div>

        <div class="section">
            <div class="section-title">üîç Reachability:</div>
            <span style="display:inline-block;padding:3px 10px;border-radius:12px;
                         background:#dc3545;color:white;font-size:0.85em;font-weight:bold;">
                Confirmed Reachable
            </span>
            <p style="margin-top:8px;font-size:0.9em;color:#555;">Tainted data flows from request.args.get (line 65) to render_template_string (line 69) with no sanitiser detected. The path is considered reachable.</p>
        </div>

        <div class="section">
            <div class="section-title">üéØ Sink API:</div>
            <code>render_template_string</code>
        </div>

        <div class="section">
            <div class="section-title">üó∫Ô∏è Attack Path:</div>
            <div style="background:#f0f0f0;padding:10px;border-radius:4px;font-size:0.9em;">
                <strong>request.args.get</strong> <small>(line 65)</small> &rarr; <strong>name</strong> <small>(line 65)</small> &rarr; <strong>f-string</strong> <small>(line 68)</small> &rarr; <strong>template</strong> <small>(line 68)</small> &rarr; <strong>render_template_string</strong> <small>(line 69)</small>
            </div>
        </div>
    </div>

    <div class="finding critical">
        <h3>Command Injection</h3>
        <span class="severity-badge" style="background-color: #dc3545;">
            CRITICAL
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 102</strong><br>
            Detector: StaticAnalysisPipeline | 
            Confidence: 90%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Tainted data reaches subprocess.check_output()
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre></pre></div>
        </div>

        <div class="section">
            <div class="section-title">üîç Reachability:</div>
            <span style="display:inline-block;padding:3px 10px;border-radius:12px;
                         background:#dc3545;color:white;font-size:0.85em;font-weight:bold;">
                Confirmed Reachable
            </span>
            <p style="margin-top:8px;font-size:0.9em;color:#555;">Tainted data flows from path (line 98) to subprocess.check_output (line 102) with no sanitiser detected. The path is considered reachable.</p>
        </div>

        <div class="section">
            <div class="section-title">üéØ Sink API:</div>
            <code>subprocess.check_output</code>
        </div>

        <div class="section">
            <div class="section-title">üó∫Ô∏è Attack Path:</div>
            <div style="background:#f0f0f0;padding:10px;border-radius:4px;font-size:0.9em;">
                <strong>path</strong> <small>(line 98)</small> &rarr; <strong>f-string</strong> <small>(line 101)</small> &rarr; <strong>cmd</strong> <small>(line 101)</small> &rarr; <strong>subprocess.check_output</strong> <small>(line 102)</small>
            </div>
        </div>
    </div>

    <div class="finding critical">
        <h3>Command Injection</h3>
        <span class="severity-badge" style="background-color: #dc3545;">
            CRITICAL
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 226</strong><br>
            Detector: StaticAnalysisPipeline | 
            Confidence: 90%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Tainted data reaches os.system()
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre></pre></div>
        </div>

        <div class="section">
            <div class="section-title">üîç Reachability:</div>
            <span style="display:inline-block;padding:3px 10px;border-radius:12px;
                         background:#fd7e14;color:white;font-size:0.85em;font-weight:bold;">
                Requires Manual Review
            </span>
            <p style="margin-top:8px;font-size:0.9em;color:#555;">Path from source (line 98) to sink (line 226) depends on runtime configuration or environment variables. Static analysis cannot determine whether the path is exercised at runtime.</p>
        </div>

        <div class="section">
            <div class="section-title">üéØ Sink API:</div>
            <code>os.system</code>
        </div>

        <div class="section">
            <div class="section-title">üó∫Ô∏è Attack Path:</div>
            <div style="background:#f0f0f0;padding:10px;border-radius:4px;font-size:0.9em;">
                <strong>path</strong> <small>(line 98)</small> &rarr; <strong>f-string</strong> <small>(line 101)</small> &rarr; <strong>cmd</strong> <small>(line 101)</small> &rarr; <strong>os.system</strong> <small>(line 226)</small>
            </div>
        </div>
    </div>

    <div class="finding high">
        <h3>ReDoS</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 116</strong><br>
            Detector: StaticAnalysisPipeline | 
            Confidence: 90%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Tainted data reaches re.match()
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre></pre></div>
        </div>

        <div class="section">
            <div class="section-title">üîç Reachability:</div>
            <span style="display:inline-block;padding:3px 10px;border-radius:12px;
                         background:#dc3545;color:white;font-size:0.85em;font-weight:bold;">
                Confirmed Reachable
            </span>
            <p style="margin-top:8px;font-size:0.9em;color:#555;">Tainted data flows from email (line 112) to re.match (line 116) with no sanitiser detected. The path is considered reachable.</p>
        </div>

        <div class="section">
            <div class="section-title">üéØ Sink API:</div>
            <code>re.match</code>
        </div>

        <div class="section">
            <div class="section-title">üó∫Ô∏è Attack Path:</div>
            <div style="background:#f0f0f0;padding:10px;border-radius:4px;font-size:0.9em;">
                <strong>email</strong> <small>(line 112)</small> &rarr; <strong>re.match</strong> <small>(line 116)</small>
            </div>
        </div>
    </div>

    <div class="finding critical">
        <h3>Code Execution</h3>
        <span class="severity-badge" style="background-color: #dc3545;">
            CRITICAL
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 136</strong><br>
            Detector: StaticAnalysisPipeline | 
            Confidence: 90%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Tainted data reaches exec()
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre></pre></div>
        </div>

        <div class="section">
            <div class="section-title">üîç Reachability:</div>
            <span style="display:inline-block;padding:3px 10px;border-radius:12px;
                         background:#dc3545;color:white;font-size:0.85em;font-weight:bold;">
                Confirmed Reachable
            </span>
            <p style="margin-top:8px;font-size:0.9em;color:#555;">Tainted data flows from code_str (line 133) to exec (line 136) with no sanitiser detected. The path is considered reachable.</p>
        </div>

        <div class="section">
            <div class="section-title">üéØ Sink API:</div>
            <code>exec</code>
        </div>

        <div class="section">
            <div class="section-title">üó∫Ô∏è Attack Path:</div>
            <div style="background:#f0f0f0;padding:10px;border-radius:4px;font-size:0.9em;">
                <strong>code_str</strong> <small>(line 133)</small> &rarr; <strong>exec</strong> <small>(line 136)</small>
            </div>
        </div>
    </div>

    <div class="finding high">
        <h3>SSRF</h3>
        <span class="severity-badge" style="background-color: #fd7e14;">
            HIGH
        </span>
        
        <div class="section">
            <div class="section-title">üìç Location:</div>
            <strong>Line 202</strong><br>
            Detector: StaticAnalysisPipeline | 
            Confidence: 90%
        </div>
        
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Issue:</div>
            Tainted data reaches requests.get()
        </div>
        
        <div class="section">
            <div class="section-title">üìÑ Vulnerable Code:</div>
            <div class="code-snippet"><pre></pre></div>
        </div>

        <div class="section">
            <div class="section-title">üîç Reachability:</div>
            <span style="display:inline-block;padding:3px 10px;border-radius:12px;
                         background:#dc3545;color:white;font-size:0.85em;font-weight:bold;">
                Confirmed Reachable
            </span>
            <p style="margin-top:8px;font-size:0.9em;color:#555;">Tainted data flows from request.args.get (line 200) to requests.get (line 202) with no sanitiser detected. The path is considered reachable.</p>
        </div>

        <div class="section">
            <div class="section-title">üéØ Sink API:</div>
            <code>requests.get</code>
        </div>

        <div class="section">
            <div class="section-title">üó∫Ô∏è Attack Path:</div>
            <div style="background:#f0f0f0;padding:10px;border-radius:4px;font-size:0.9em;">
                <strong>request.args.get</strong> <small>(line 200)</small> &rarr; <strong>url</strong> <small>(line 200)</small> &rarr; <strong>requests.get</strong> <small>(line 202)</small>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>Generated by AI Code Breaker: LLM Security Scanner</p>
        <p>Review all findings and implement suggested fixes to improve security</p>
    </div>
</body>
</html>
