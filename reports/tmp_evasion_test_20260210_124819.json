{
  "scan_info": {
    "scan_id": "local-1770745699",
    "file_name": "tmp_evasion_test.py",
    "language": "python",
    "scan_timestamp": "2026-02-10 12:48:19",
    "total_findings": 3
  },
  "summary": {
    "total": 3,
    "by_severity": {
      "CRITICAL": 2,
      "HIGH": 1
    },
    "by_type": {
      "Unsafe Deserialization": 1,
      "Path Traversal": 1,
      "Command Injection": 1
    }
  },
  "reachability_summary": {
    "Confirmed Reachable": 3,
    "Reachability Eliminated": 0,
    "Unverifiable": 0,
    "Requires Manual Review": 0,
    "Not Analysed": 0
  },
  "attack_paths": [],
  "reachability": [],
  "findings": [
    {
      "detector_name": "EvasionPatternsDetector",
      "vulnerability_type": "Unsafe Deserialization",
      "severity": "CRITICAL",
      "line_number": 12,
      "code_snippet": "  9   | \n 10   | def demo(data, path, cmd):\n 11   |     if verify_signature(data):\n 12 \u2192 |         pickle.loads(data)\n 13   | \n 14   |     if \"..\" in path:\n 15   |         raise ValueError(\"blocked\")\n 16   |     with open(path, \"r\", encoding=\"utf-8\") as f:",
      "description": "Unsafe deserialization occurs after a signature/auth check. Authentication of bytes does not make pickle/yaml object construction safe; attacker-controlled signed payloads can still trigger gadget-based code execution.",
      "confidence": 0.96,
      "cwe_id": "CWE-502",
      "owasp_category": "A08:2021 \u2013 Software and Data Integrity Failures",
      "metadata": {
        "pattern": "signature_gate_then_unsafe_deserialization",
        "sink": "pickle.loads"
      },
      "reachability_status": "Confirmed Reachable",
      "reachability_reasoning": "Tainted data flows from data (line 10) to pickle.loads (line 12) with no sanitiser detected. The path is considered reachable.",
      "attack_path": {
        "source": {
          "name": "data",
          "file": "tmp_evasion_test.py",
          "line": 10,
          "detail": "Parameter 'data' of function 'demo' (treated as untrusted input)"
        },
        "transforms": [],
        "sink": {
          "name": "pickle.loads",
          "file": "tmp_evasion_test.py",
          "line": 12,
          "detail": "Tainted data reaches pickle.loads()"
        },
        "vulnerability_type": "Unsafe Deserialization",
        "severity": "CRITICAL",
        "cwe_id": "CWE-502"
      },
      "sink_api": "pickle.loads"
    },
    {
      "detector_name": "EvasionPatternsDetector",
      "vulnerability_type": "Path Traversal",
      "severity": "HIGH",
      "line_number": 16,
      "code_snippet": " 13   | \n 14   |     if \"..\" in path:\n 15   |         raise ValueError(\"blocked\")\n 16 \u2192 |     with open(path, \"r\", encoding=\"utf-8\") as f:\n 17   |         return f.read()\n 18   | \n 19   |     safe = shlex.quote(cmd)\n 20   |     os.system(f\"echo {safe}\")",
      "description": "Path validation uses ASCII-only '..' checks without unicode/encoding normalization. Encoded separators or homoglyphs can bypass this guard.",
      "confidence": 0.93,
      "cwe_id": "CWE-22",
      "owasp_category": "A01:2021 \u2013 Broken Access Control",
      "metadata": {
        "pattern": "unicode_traversal_bypass",
        "path_var": "path"
      },
      "reachability_status": "Confirmed Reachable",
      "reachability_reasoning": "Tainted data flows from path (line 10) to open (line 16) with no sanitiser detected. The path is considered reachable.",
      "attack_path": {
        "source": {
          "name": "path",
          "file": "tmp_evasion_test.py",
          "line": 10,
          "detail": "Parameter 'path' of function 'demo' (treated as untrusted input)"
        },
        "transforms": [],
        "sink": {
          "name": "open",
          "file": "tmp_evasion_test.py",
          "line": 16,
          "detail": "Tainted data reaches open()"
        },
        "vulnerability_type": "Path Traversal",
        "severity": "HIGH",
        "cwe_id": "CWE-22"
      },
      "sink_api": "open"
    },
    {
      "detector_name": "EvasionPatternsDetector",
      "vulnerability_type": "Command Injection",
      "severity": "CRITICAL",
      "line_number": 20,
      "code_snippet": " 17   |         return f.read()\n 18   | \n 19   |     safe = shlex.quote(cmd)\n 20 \u2192 |     os.system(f\"echo {safe}\")\n 21   | ",
      "description": "shlex.quote() is used, but command is executed through a shell. Quoting is not a complete defense for shell-based execution paths; use argument lists with subprocess.run(..., shell=False).",
      "confidence": 0.95,
      "cwe_id": "CWE-78",
      "owasp_category": "A03:2021 \u2013 Injection",
      "metadata": {
        "pattern": "shlex_quote_with_shell_execution",
        "quoted_var": "safe"
      },
      "reachability_status": "Confirmed Reachable",
      "reachability_reasoning": "Tainted data flows from cmd (line 10) to os.system (line 20) with no sanitiser detected. The path is considered reachable.",
      "attack_path": {
        "source": {
          "name": "cmd",
          "file": "tmp_evasion_test.py",
          "line": 10,
          "detail": "Parameter 'cmd' of function 'demo' (treated as untrusted input)"
        },
        "transforms": [
          {
            "name": "safe",
            "file": "tmp_evasion_test.py",
            "line": 19,
            "detail": "Variable 'safe' receives tainted data"
          },
          {
            "name": "f-string",
            "file": "tmp_evasion_test.py",
            "line": 20,
            "detail": "Tainted value interpolated into f-string"
          }
        ],
        "sink": {
          "name": "os.system",
          "file": "tmp_evasion_test.py",
          "line": 20,
          "detail": "Tainted data reaches os.system()"
        },
        "vulnerability_type": "Command Injection",
        "severity": "CRITICAL",
        "cwe_id": "CWE-78"
      },
      "sink_api": "os.system"
    }
  ]
}